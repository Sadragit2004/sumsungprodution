{% extends "main_template.html" %}

{% block content %}

<main class="pt-24 md:pt-48 px-2 md:px-10">
    <!-- new blogs slider -->
    <div class="md:mt-10 px-4 md:px-14">
      <!-- top blog -->
      <div class="flex gap-x-4 justify-between items-center mb-7">
        <div class="h-[1px] w-full bg-gradient-to-r from-white via-zinc-300 to-white">
        </div>
        <div class="w-48 min-w-fit text-zinc-700 md:font-yekanBakhBold md:text-lg">
          جدیدترین مقالات
        </div>
        <div class="h-[1px] w-full bg-gradient-to-r from-white via-zinc-300 to-white">
        </div>
      </div>
      <!-- main blog -->
      <div class="containerPSlider swiper">
        <div class="newBlogs">
          <div class="card-wrapper swiper-wrapper pb-10">
            {% for post in popular_posts %}
            <div class="card swiper-slide bg-white min-h-60 rounded-2xl border hover:border-primary-500 transition border-zinc-300 group p-2 md:p-3 hover:drop-shadow-lg">
              <a href="{{ post.get_absolute_url }}" class="image-box block overflow-hidden rounded-lg md:rounded-2xl">
                {% if post.cover_image %}
                <img class="rounded-lg md:rounded-2xl max-h-56 w-full transition-transform duration-300 ease-in-out group-hover:rotate-3 group-hover:scale-110"
                     src="{{ post.cover_image.url }}"
                     alt="{{ post.title }}" />
                {% else %}
                <img class="rounded-lg md:rounded-2xl max-h-56 w-full transition-transform duration-300 ease-in-out group-hover:rotate-3 group-hover:scale-110"
                     src="{{ media_url }}image/blog/default.jpg"
                     alt="{{ post.title }}" />
                {% endif %}
              </a>
              <div class="p-2 mt-2">
                <a href="{{ post.get_absolute_url }}" class="text-xs md:text-sm font-normal md:font-semibold text-zinc-700 group-hover:text-primary-500 h-12 line-clamp-2 leading-6">
                  {{ post.title }}
                </a>
                <div class="flex justify-between mt-8">
                  <div class="text-xs flex gap-x-1 items-center text-zinc-400">
                    <svg class="fill-zinc-400" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="" viewBox="0 0 256 256">
                      <path d="M208,32H184V24a8,8,0,0,0-16,0v8H88V24a8,8,0,0,0-16,0v8H48A16,16,0,0,0,32,48V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V48A16,16,0,0,0,208,32ZM72,48v8a8,8,0,0,0,16,0V48h80v8a8,8,0,0,0,16,0V48h24V80H48V48ZM208,208H48V96H208V208Z"></path>
                    </svg>
                    {{ post.publish_at|date:"Y/m/d" }}
                  </div>
                  <a href="{{ post.get_absolute_url }}" class="flex justify-center items-center gap-x-1 group w-fit text-xs md:text-sm transition text-zinc-600 group-hover:text-primary-500">
                    ادامه مطلب
                    <svg class="fill-zinc-600 transition group-hover:fill-primary-500 size-2 md:size-4" xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="" viewBox="0 0 256 256">
                      <path d="M224,128a8,8,0,0,1-8,8H59.31l58.35,58.34a8,8,0,0,1-11.32,11.32l-72-72a8,8,0,0,1,0-11.32l72-72a8,8,0,0,1,11.32,11.32L59.31,120H216A8,8,0,0,1,224,128Z"></path>
                    </svg>
                  </a>
                </div>
              </div>
            </div>
            {% endfor %}
          </div>
        </div>
      </div>
    </div>

    <!-- main blogs -->
    <div class="px-3 lg:px-10 md:flex gap-x-5 pt-10">
      <!-- Sidebar - Categories -->
      <div class="md:w-3/12">
        <div class="px-2 sm:px-3 py-3 bg-white rounded-xl border border-zinc-300 space-y-3">
          <a href="" class="mx-auto flex gap-x-1 group items-center md:font-semibold text-right w-full px-2 py-3 text-sm cursor-pointer hover:bg-primary-500 hover:text-white transition text-zinc-700 rounded-lg {% if not active_category %}bg-primary-500 text-white{% endif %}">
            <svg class="{% if not active_category %}fill-white{% else %}group-hover:fill-white transition-colors{% endif %}" xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="#3d3d3d" viewBox="0 0 256 256">
              <path d="M88,112a8,8,0,0,1,8-8h80a8,8,0,0,1,0,16H96A8,8,0,0,1,88,112Zm8,40h80a8,8,0,0,0,0-16H96a8,8,0,0,0,0,16ZM232,64V184a24,24,0,0,1-24,24H32A24,24,0,0,1,8,184.11V88a8,8,0,0,1,16,0v96a8,8,0,0,0,16,0V64A16,16,0,0,1,56,48H216A16,16,0,0,1,232,64Zm-16,0H56V184a23.84,23.84,0,0,1-1.37,8H208a8,8,0,0,0,8-8Z"></path>
            </svg>
            جدیدترین ها
          </a>

          {% for category in categories %}
          <a href="" class="mx-auto flex gap-x-1 group items-center md:font-semibold text-right w-full px-2 py-3 text-sm cursor-pointer hover:bg-primary-500 hover:text-white transition text-zinc-700 rounded-lg {% if active_category == category.slug %}bg-primary-500 text-white{% endif %}">
            <svg class="{% if active_category == category.slug %}fill-white{% else %}group-hover:fill-white transition-colors{% endif %}" xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="#3d3d3d" viewBox="0 0 256 256">
              <path d="M248,124a56.11,56.11,0,0,0-32-50.61V72a48,48,0,0,0-88-26.49A48,48,0,0,0,40,72v1.39a56,56,0,0,0,0,101.2V176a48,48,0,0,0,88,26.49A48,48,0,0,0,216,176v-1.41A56.09,56.09,0,0,0,248,124ZM88,208a32,32,0,0,1-31.81-28.56A55.87,55.87,0,0,0,64,180h8a8,8,0,0,0,0-16H64A40,40,0,0,1,50.67,86.27,8,8,0,0,0,56,78.73V72a32,32,0,0,1,64,0v68.26A47.8,47.8,0,0,0,88,128a8,8,0,0,0,0,16,32,32,0,0,1,0,64Zm104-44h-8a8,8,0,0,0,0,16h8a55.87,55.87,0,0,0,7.81-.56A32,32,0,1,1,168,144a8,8,0,0,0,0-16,47.8,47.8,0,0,0-32,12.26V72a32,32,0,0,1,64,0v6.73a8,8,0,0,0,5.33,7.54A40,40,0,0,1,192,164Zm16-52a8,8,0,0,1-8,8h-4a36,36,0,0,1-36-36V80a8,8,0,0,1,16,0v4a20,20,0,0,0,20,20h4A8,8,0,0,1,208,112ZM60,120H56a8,8,0,0,1,0-16h4A20,20,0,0,0,80,84V80a8,8,0,0,1,16,0v4A36,36,0,0,1,60,120Z"></path>
            </svg>
            {{ category.name }}
          </a>
          {% endfor %}
        </div>
      </div>

      <!-- Main Content -->
      <div class="md:w-9/12 mt-5 md:mt-0">
        <!-- section blog -->
        <div class="rounded-2xl mx-auto text-gray-100">
          <!-- main blog -->
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 md:gap-5">
            {% for post in posts %}
            <div class="card swiper-slide bg-white min-h-60 rounded-2xl border hover:border-primary-500 transition border-zinc-300 group p-2 md:p-3 hover:drop-shadow-lg">
              <a href="{% url 'blog:detail' slug=post.slug %}" class="image-box block overflow-hidden rounded-lg md:rounded-2xl">
                {% if post.cover_image %}
                <img class="rounded-lg md:rounded-2xl max-h-56 w-full transition-transform duration-300 ease-in-out group-hover:rotate-3 group-hover:scale-110"
                     src="{{ post.cover_image.url }}"
                     alt="{{ post.title }}" />
                {% else %}
                <img class="rounded-lg md:rounded-2xl max-h-56 w-full transition-transform duration-300 ease-in-out group-hover:rotate-3 group-hover:scale-110"
                     src="{{ media_url }}image/blog/default.jpg"
                     alt="{{ post.title }}" />
                {% endif %}
              </a>
              <div class="p-2 mt-2">
                <a href="{% url 'blog:detail' slug=post.slug %}" class="text-xs md:text-sm font-normal md:font-semibold text-zinc-700 group-hover:text-primary-500 h-12 line-clamp-2 leading-6">
                  {{ post.title }}
                </a>
                <div class="flex justify-between mt-8">
                  <div class="text-xs flex gap-x-1 items-center text-zinc-400">
                    <svg class="fill-zinc-400" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="" viewBox="0 0 256 256">
                      <path d="M208,32H184V24a8,8,0,0,0-16,0v8H88V24a8,8,0,0,0-16,0v8H48A16,16,0,0,0,32,48V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V48A16,16,0,0,0,208,32ZM72,48v8a8,8,0,0,0,16,0V48h80v8a8,8,0,0,0,16,0V48h24V80H48V48ZM208,208H48V96H208V208Z"></path>
                    </svg>
                    {{ post.publish_at|date:"Y/m/d" }}
                  </div>
                
                </div>
              </div>
            </div>
            {% empty %}
            <div class="col-span-3 text-center py-12">
              <p class="text-zinc-500 text-lg">مقاله‌ای یافت نشد.</p>
            </div>
            {% endfor %}
          </div>
        </div>

        <!-- pagination -->
        {% if is_paginated %}
        <div class="flex justify-center my-12">
          {% if page_obj.has_previous %}
          <a href="?page={{ page_obj.previous_page_number }}{% if active_category %}&category={{ active_category }}{% endif %}" class="flex items-center justify-center px-3.5 md:px-4 py-2 mx-1 text-gray-700 transition-colors duration-300 transform bg-white rounded-md -scale-x-100 hover:bg-primary-500 hover:text-white">
            <svg xmlns="http://www.w3.org/2000/svg" class="size-4 md:size-5" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd" />
            </svg>
          </a>
          {% endif %}

          {% for num in page_obj.paginator.page_range %}
            {% if page_obj.number == num %}
            <a href="?page={{ num }}{% if active_category %}&category={{ active_category }}{% endif %}" class="border border-zinc-100 text-sm md:text-base px-3.5 md:px-4 py-2 mx-1 transition-colors duration-300 transform bg-primary-500 text-white rounded-md">
                {{ num }}
            </a>
            {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
            <a href="?page={{ num }}{% if active_category %}&category={{ active_category }}{% endif %}" class="border border-zinc-100 text-sm md:text-base px-3.5 md:px-4 py-2 mx-1 text-gray-700 transition-colors duration-300 transform bg-white rounded-md hover:bg-primary-500 hover:text-white">
                {{ num }}
            </a>
            {% endif %}
          {% endfor %}

          {% if page_obj.has_next %}
          <a href="?page={{ page_obj.next_page_number }}{% if active_category %}&category={{ active_category }}{% endif %}" class="flex items-center justify-center px-3.5 md:px-4 py-2 mx-1 text-gray-700 transition-colors duration-300 transform bg-white rounded-md -scale-x-100 hover:bg-primary-500 hover:text-white">
            <svg xmlns="http://www.w3.org/2000/svg" class="size-4 md:size-5" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd" />
            </svg>
          </a>
          {% endif %}
        </div>
        {% endif %}
      </div>
    </div>
</main>

<br><br>
{% endblock content %}